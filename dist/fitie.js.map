{"version":3,"sources":["fitie.js"],"names":["window","fitie","node","onload","removeEventListener","call","on","type","imgCSS","boxSizing","display","overflow","replace","key","getCSS","setCSS","border","margin","padding","height","width","opacity","innerWidth","videoWidth","innerHeight","videoHeight","innerRatio","imgx","document","createElement","appendChild","parentNode","replaceChild","runtimeStyle","newSize","objectFit","img","outerWidth","outerHeight","outerRatio","Math","round","marginLeft","marginTop","currentStyle","test","clientWidth","clientHeight","name","nodeName","toLowerCase","addEventListener","attachEvent","detachEvent","complete","init","body","all","querySelectorAll","index","setTimeout","watch","runCallback","requestAnimationFrame","navigator","userAgent"],"mappings":"AAAAA,OAAAC,MAAA,SAAAC,GA0BA,QAAAC,KACAC,EAAAC,KAAAH,EAAAI,EAAAC,EAAAJ,EAGA,IAAAK,IACAC,UAAA,cACAC,QAAA,eACAC,SAAA,SAGA,iKAAAC,QAAA,OAAA,SAAAC,GACAL,EAAAK,GAAAC,EAAAD,KAIAE,EAAAC,OAAAD,EAAAE,OAAAF,EAAAG,QAAA,EACAH,EAAAL,QAAA,QACAK,EAAAI,OAAAJ,EAAAK,MAAA,OACAL,EAAAM,QAAA,CAEA,IAAAC,GAAApB,EAAAqB,YAAArB,EAAAkB,MACAI,EAAAtB,EAAAuB,aAAAvB,EAAAiB,OACAO,EAAAJ,EAAAE,EAGAG,EAAAC,SAAAC,cAAA,aAEAF,GAAAG,YAAA5B,EAAA6B,WAAAC,aAAAL,EAAAzB,GAEA,KAAA,GAAAW,KAAAL,GAAAmB,EAAAM,aAAApB,GAAAL,EAAAK,EAGA,IAAAqB,EAEA,UAAAC,EACAC,GACArB,EAAAK,MAAAiB,EACAtB,EAAAI,OAAAmB,IAEAvB,EAAA,wBAAA,QACAA,EAAA,iBAAA,SAAAsB,EAAAf,EAAA,IAAAgB,EAAAd,EAAA,MAEAE,EAAAa,EAAA,YAAAJ,EAAA,UAAAA,IACAD,EAAAI,EAAAZ,EAEAX,EAAAK,MAAAoB,KAAAC,MAAAP,GAAA,KACAnB,EAAAI,OAAAmB,EAAA,KACAvB,EAAA2B,WAAAF,KAAAC,OAAAJ,EAAAH,GAAA,GAAA,OAEAA,EAAAG,EAAAX,EAEAX,EAAAK,MAAAiB,EAAA,KACAtB,EAAAI,OAAAqB,KAAAC,MAAAP,GAAA,KACAnB,EAAA4B,UAAAH,KAAAC,OAAAH,EAAAJ,GAAA,GAAA,MA7EA,GAAAC,GAAAjC,EAAA0C,aAAA1C,EAAA0C,aAAA,cAAA,IAEA,IAAAT,GAAA,yBAAAU,KAAAV,GAAA,CAGA,GAAAE,GAAAnC,EAAA4C,YACAR,EAAApC,EAAA6C,aACAR,EAAAF,EAAAC,EAEAU,EAAA9C,EAAA+C,SAAAC,cAEAnC,EAAAb,EAAA+B,aACAnB,EAAAZ,EAAA0C,aAEAO,EAAAjD,EAAAiD,kBAAAjD,EAAAkD,YACAhD,EAAAF,EAAAE,qBAAAF,EAAAmD,YACA/C,EAAAJ,EAAAiD,iBAAA,GAAA,KACAf,EAAA,QAAAY,EACAzC,EAAA6B,EAAA,OAAA,gBAEAe,GAAA9C,KAAAH,EAAAI,EAAAC,EAAAJ,GAEAD,EAAAoD,UAAAnD,MA2DAH,OAAAC,MAAAsD,KAAA,WACA,GAAA3B,SAAA4B,KAIA,IAHA,GAAAC,GAAA7B,SAAA8B,iBAAA,aACAC,KAEAF,IAAAE,IAAA3D,OAAAC,MAAAwD,EAAAE,QAEAC,YAAA5D,OAAAC,MAAAsD,OAIAvD,OAAAC,MAAA4D,MAAA,WACA,QAAAC,KACA9D,OAAA+D,sBACA/D,OAAA+D,sBAAA/D,OAAAC,MAAAsD,MAEAK,WAAA5D,OAAAC,MAAAsD,KAAA,IAIA3B,SAAAuB,iBAAA,SAAAW,IAGA9D,OAAAC,MAAA4C,KAAA,WACA,eAAAA,KAAAmB,UAAAC,aACAjE,OAAAC,MAAAsD,OACAvD,OAAAC,MAAA4D,UAIA7D,OAAAC,MAAA4C","file":"fitie.js","sourcesContent":["window.fitie = function (node) {\n\t// restrict to valid object-fit value\n\tvar objectFit = node.currentStyle ? node.currentStyle['object-fit'] : null;\n\n\tif (!objectFit || !/^(contain|cover|fill)$/.test(objectFit)) return;\n\n\t// prepare container styles\n\tvar outerWidth  = node.clientWidth;\n\tvar outerHeight = node.clientHeight;\n\tvar outerRatio  = outerWidth / outerHeight;\n\n\tvar name = node.nodeName.toLowerCase();\n\n\tvar setCSS = node.runtimeStyle;\n\tvar getCSS = node.currentStyle;\n\n\tvar addEventListener = node.addEventListener || node.attachEvent;\n\tvar removeEventListener = node.removeEventListener || node.detachEvent;\n\tvar on = node.addEventListener ? '' : 'on';\n\tvar img = name === 'img';\n\tvar type = img ? 'load' : 'loadedmetadata';\n\n\taddEventListener.call(node, on + type, onload);\n\n\tif (node.complete) onload();\n\n\tfunction onload() {\n\t\tremoveEventListener.call(node, on + type, onload);\n\n\t\t// prepare container styles\n\t\tvar imgCSS = {\n\t\t\tboxSizing: 'content-box',\n\t\t\tdisplay:   'inline-block',\n\t\t\toverflow:  'hidden'\n\t\t};\n\n\t\t'backgroundColor backgroundImage borderColor borderStyle borderWidth bottom fontSize lineHeight height left opacity margin position right top visibility width'.replace(/\\w+/g, function (key) {\n\t\t\timgCSS[key] = getCSS[key];\n\t\t});\n\n\t\t// prepare image styles\n\t\tsetCSS.border = setCSS.margin = setCSS.padding = 0;\n\t\tsetCSS.display = 'block';\n\t\tsetCSS.height = setCSS.width = 'auto';\n\t\tsetCSS.opacity = 1;\n\n\t\tvar innerWidth  = node.videoWidth || node.width;\n\t\tvar innerHeight = node.videoHeight || node.height;\n\t\tvar innerRatio  = innerWidth / innerHeight;\n\n\t\t// style container\n\t\tvar imgx = document.createElement('object-fit');\n\n\t\timgx.appendChild(node.parentNode.replaceChild(imgx, node));\n\n\t\tfor (var key in imgCSS) imgx.runtimeStyle[key] = imgCSS[key];\n\n\t\t// style image\n\t\tvar newSize;\n\n\t\tif (objectFit === 'fill') {\n\t\t\tif (img) {\n\t\t\t\tsetCSS.width = outerWidth;\n\t\t\t\tsetCSS.height = outerHeight;\n\t\t\t} else {\n\t\t\t\tsetCSS['-ms-transform-origin'] = '0% 0%';\n\t\t\t\tsetCSS['-ms-transform'] = 'scale(' + outerWidth / innerWidth + ',' + outerHeight / innerHeight + ')';\n\t\t\t}\n\t\t} else if (innerRatio < outerRatio ? objectFit === 'contain' : objectFit === 'cover') {\n\t\t\tnewSize = outerHeight * innerRatio;\n\n\t\t\tsetCSS.width  = Math.round(newSize) + 'px';\n\t\t\tsetCSS.height = outerHeight + 'px';\n\t\t\tsetCSS.marginLeft = Math.round((outerWidth - newSize) / 2) + 'px';\n\t\t} else {\n\t\t\tnewSize = outerWidth / innerRatio;\n\n\t\t\tsetCSS.width  = outerWidth + 'px';\n\t\t\tsetCSS.height = Math.round(newSize) + 'px';\n\t\t\tsetCSS.marginTop = Math.round((outerHeight - newSize) / 2) + 'px';\n\t\t}\n\t}\n};\nwindow.fitie.init = function () {\n\tif (document.body) {\n\t\tvar all = document.querySelectorAll('img,video');\n\t\tvar index = -1;\n\n\t\twhile (all[++index]) {window.fitie(all[index])};\n\t} else {\n\t\tsetTimeout(window.fitie.init);\n\t}\n};\n\nwindow.fitie.watch = function() {\n\tfunction runCallback() {\n\t\tif (window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame(window.fitie.init);\n\t\t} else {\n\t\t\tsetTimeout(window.fitie.init, 66)\n\t\t}\n\t}\n\n\tdocument.addEventListener('resize', runCallback)\n}\n\nwindow.fitie.test = function() {\n\tif (/MSIE|Trident/.test(navigator.userAgent)) {\n\t\twindow.fitie.init();\n\t\twindow.fitie.watch();\n\t};\n}\n\nwindow.fitie.test();\n"]}